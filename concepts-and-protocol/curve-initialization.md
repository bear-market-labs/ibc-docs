# Curve Initialization

Any user is able to generate an IBC curve by providing an initial amount of an ERC20 token as the selected reserve asset. An IBC is created per reserve asset type, and only one IBC can exist per reserve asset type.&#x20;

An IBC using ETH as the reserve asset is created at protocol genesis, with ibETH (the minted ibAsset) marking the first history of assets that follow inversed market dynamics. Other types of ibAssets can be generated by any user providing ERC20 reserve assets.&#x20;

The provided initial parameter values of initial liquidity reserves ($$R_0$$) is used to compute the initial minted supply ($$S_0$$), and the starting spot price ($$P_0$$).&#x20;



## Initial Parameters

The curve initializes to contain the provided $$R_0$$ amount of liquidity reserves. The generated IBC starts off with a price curve equation of:&#x20;

$$
price=\frac{1}{\sqrt{supply}}
$$

Where the price starts as $$1$$ ibAsset = $$1$$ reserve asset at a minted ibAsset supply of $$1$$.&#x20;



The initial minted supply and price values are then calculated as:&#x20;

$$
S_0=\frac{{R_0}^{2}}{4}
$$

$$
P_0=\frac{2}{R_0}
$$



### Minimum Initial Reserve

A minimum amount of initial reserves is enforced, preventing rounding errors during further interactions. The minimum initial reserve is set as $$0.0002$$ reserve assets for all initializing IBCs. The minimum initial reserve is made non-withdrawable and is locked in the IBC eternally.



### Initial LP Token Supply

The IBC also starts with an initial minted supply of LP tokens, later used to calculate the LP token mint amounts to those providing liquidity to the initialized curve. The initial LP token amount is calculated as:&#x20;

$$
P_0\left(R_0-P_0S_0\right)
$$

Which is equal to the initial price, times the specified amount of virtual reserves minus the amount of virtual reserves that would be needed to fully back the initial virtual minted supply at the initial price.&#x20;

The LP token amount minted for the minimum initial reserve is also made non-removable, preventing potential rounding errors.&#x20;



### Curve Formation

Following from a generic IBC of $$\frac{m}{x^k}$$, the initialized curve must show a spot price of $$P_0$$ at a minted virtual supply of $$S_0$$:&#x20;

$$
\frac{m}{{S_0}^k}=P_0
$$

The curve should also contain a liquidity reserve of $$R_0$$ at a minted supply of $$S_0$$:&#x20;

$$
\int_{0}^{S_0}\frac{m}{x^{k}}dx=\frac{m{S_0}^{1-k}}{1-k}=R_0
$$

Whereby combining the two yields the values for $$m$$and $$k$$:&#x20;

$$
m=P_0{S_0}^{1-\frac{P_0S_0}{R_0}},\,k=1-\frac{P_0S_0}{R_0}
$$

The curve is then defined as the below:&#x20;

$$
P(x)=P_0{\left(\frac{S_0}{S_0+x}\right)}^{1-\frac{P_0S_0}{R_0}}
$$

Where $$x$$ is the amount of ibAssets being minted by further interactions post-initialization.&#x20;



### Curve Invariant

The generated IBC is observed to have the below invariant ($$i$$) as mints and burns occur. $$i$$ does not update during mints and burns, but updates with LP additions and withdraws.

$$
i=\frac{R}{S^{u}}
$$

$$u$$ represents the utilization of provided liquidity vs. liquidity used to back minted ibAssets at the current spot price. $$u$$ is defined at curve initialization and is made to never update. $$u$$ is defined as:&#x20;

$$
u=\frac{PS}{R}=0.5
$$

For all initialized IBCs, $$u$$ is always set to have a value of $$0.5$$.&#x20;



With initialized values of $$R_0$$, $$S_0$$, $$P_0$$, the values $$i$$ and $$u$$ are set as:&#x20;

$$
i=\frac{R_0}{{S_0}^{u}},\,u=\frac{P_0S_0}{R_0}=0.5
$$

The newly added values of $$i$$ and $$u$$ allow the price curve to also be written as:&#x20;

$$
P(x)=\frac{iu}{{\left(S_0+x\right)}^{1-u}}
$$

The invariant is used extensively in the IBC's implementation.&#x20;
